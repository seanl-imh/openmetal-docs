<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">How to Enable TLS for OpenStack using Kolla Ansible | Openmetal Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://openmetalio.github.io/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="How to Enable TLS for OpenStack using Kolla Ansible | Openmetal Docs"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><link data-react-helmet="true" rel="icon" href="/openmetal-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://openmetalio.github.io/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls"><link data-react-helmet="true" rel="alternate" href="https://openmetalio.github.io/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://openmetalio.github.io/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls" hreflang="x-default"><link rel="stylesheet" href="/openmetal-docs/assets/css/styles.0b4a7092.css">
<link rel="preload" href="/openmetal-docs/assets/js/runtime~main.7dbb6dff.js" as="script">
<link rel="preload" href="/openmetal-docs/assets/js/main.3b3d27ad.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/openmetal-docs/"><div class="navbar__logo"><img src="/openmetal-docs/img/openmetal.svg" alt="Openmetal" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/openmetal-docs/img/openmetal.svg" alt="Openmetal" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openmetalio/openmetal-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/openmetal-docs/docs/users_manual/">User&#x27;s Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;User&#x27;s Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/openmetal-docs/docs/operators-manual/">Operator&#x27;s Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator&#x27;s Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-1/command-line/create-ssh-key">Day 1</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-2/resource-usage/cloud-resource-usage">Day 2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-3/add-provider-ips">Day 3</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/automation/heat">Day 4</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/automation/heat">Automation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/">Kolla Ansible</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kolla Ansible&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-elk">How to Enable Elasticsearch and Kibana using Kolla Ansible</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls">How to Enable TLS for OpenStack using Kolla Ansible</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/redeploy-rabbitmq">How to Redeploy OpenStack&#x27;s RabbitMQ Cluster using Kolla Ansible</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/security/security-best-practices">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/troubleshooting/ceph">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/operators-manual/day-4/watcher/watcher-demo">Watcher</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/openmetal-docs/docs/operators-manual-extras/">Operator&#x27;s Manual Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator&#x27;s Manual Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/openmetal-docs/docs/how-to-guides/horizon/live-migrate-instance">How to Guides</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>How to Enable TLS for OpenStack using Kolla Ansible</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>By default, Private Clouds are not configured with an SSL encrypting the
network traffic from your machine to your Private Cloud&#x27;s OpenStack
dashboard, called Horizon. Without encryption, information is sent in
plaintext, meaning someone could see the password you used to log in to
Horizon. In this guide, we explain how to configure an SSL for the
public, or external, network of your Private Cloud.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="table-of-contents">Table of Contents<a class="hash-link" href="#table-of-contents" title="Direct link to heading">​</a></h2><ol><li><p><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#prerequisites">Prerequisites</a></p></li><li><ul><li><p><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#specify-an-external-fully-qualified-domain-name-for-horizon">Specify an External Fully Qualified Domain Name for
Horizon</a></p><ol><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#determine-public-ip">Determine Public
IP</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#configure-an-fqdn">Configure an
FQDN</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#apply-configuration-change-using-kolla-ansible">Apply Configuration Change Using Kolla
Ansible</a></li></ol></li></ul></li><li><ul><li><p><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#enable-ssl-externally-encrypting-horizon-traffic">Enable SSL Externally, Encrypting Horizon
Traffic</a></p><ol><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#modify-kolla-ansible-configuration">Modify Kolla Ansible
Configuration</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#configure-root-ca-bundle">Configure Root CA
Bundle</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#prepare-ssl-file">Prepare SSL
File</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#specify-ssl-certificate">Specify SSL
Certificate</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#enable-external-tls">Enable External
TLS</a></li><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#reconfigure-cloud-using-kolla-ansible">Reconfigure Cloud using Kolla
Ansible</a></li></ol></li></ul></li><li><ul><li><p><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#reconfigure-ceph-cluster-using-ceph-ansible">Reconfigure Ceph Cluster using Ceph
Ansible</a></p><ol><li><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#procedure">Procedure</a></li></ol></li></ul></li><li><p><a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-tls#reference">Reference</a></p></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><ul><li><strong>Prepare Kolla Ansible</strong>: This guide explains how to configure your
cloud with an SSL using Kolla Ansible. Any time you work with Kolla
Ansible, you must prepare a shell environment. For more, see <a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/">How to
Prepare and Use Kolla
Ansible</a>.
The remaining instruction assume this environment has been prepared.
All commands are to be executed from the control plane node where
this environment has been prepared.</li><li><strong>Prepare Ceph Ansible</strong>: This guide makes use of Ceph Ansible to
reconfigure your cloud&#x27;s Ceph cluster. When working with Ceph
Ansible, you must first prepare a shell environment. For more, see
<a href="/openmetal-docs/docs/operators-manual/day-4/ceph-ansible/">How to Prepare and Use Ceph
Ansible</a>. The
portion of this guide that has to do with using Ceph Ansible assumes
this environment has been prepared.</li><li><strong>Root Access</strong>: Root access to your cloud&#x27;s control plane nodes is
required.</li><li><strong>Provide your own SSL Files</strong>: This guide requires the private key,
certificate and intermediate chain. Your certificate and
intermediate chain may be combined as a &quot;Full Chain&quot;.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="specify-an-external-fully-qualified-domain-name-for-horizon">Specify an External Fully Qualified Domain Name for Horizon<a class="hash-link" href="#specify-an-external-fully-qualified-domain-name-for-horizon" title="Direct link to heading">​</a></h2><p>Before configuring your cloud with an SSL, a Fully Qualified Domain Name
(FQDN) must be configured. The FQDN should have its DNS A record
adjusted to point to the public IP of your cloud. This section explains
how to prepare your cloud with an FQDN and how to determine the public
IP of your cloud.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="determine-public-ip">Determine Public IP<a class="hash-link" href="#determine-public-ip" title="Direct link to heading">​</a></h3><p>Within <code>/etc/kolla/globals.yml</code>, your cloud&#x27;s public IP is defined by
the key <code>kolla_external_vip_address</code>.</p><p>For example:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ grep kolla_external_vip_address /etc/kolla/globals.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kolla_external_vip_address: 173.231.254.164</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For this example, the FQDN selected should have a DNS A record pointed
to <strong>173.231.254.164</strong>. Ensure your FQDN&#x27;s A record is pointed to the
value defined by <code>kolla_external_vip_address</code> within your cloud&#x27;s
<code>/etc/kolla/globals.yml</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configure-an-fqdn">Configure an FQDN<a class="hash-link" href="#configure-an-fqdn" title="Direct link to heading">​</a></h3><p>To specify a domain name for Horizon, within <code>/etc/kolla/globals.yml</code>,
set the value for <code>kolla_external_fqdn</code> to the domain of your choosing.
<strong>Note</strong> your <code>/etc/kolla/globals.yml</code> may not have a line containing
<code>kolla_external_fqdn</code>. If this line is not present, append it the file.</p><p>For example, to set the FQDN for a cloud to be <strong>cloud.domain.com</strong>,
use:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">kolla_external_fqdn: cloud.domain.com</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="apply-configuration-change-using-kolla-ansible">Apply Configuration Change Using Kolla Ansible<a class="hash-link" href="#apply-configuration-change-using-kolla-ansible" title="Direct link to heading">​</a></h3><p>With the FQDN configured, Kolla Ansible must be used to apply that
configuration before proceeding with this guide. Before proceeding with
this section, ensure you have <a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/">prepared a Kolla Ansible
environment</a>.
Also ensure the node from which Kolla Ansible has been prepared contains
the file <code>/etc/fm-deploy/kolla-ansible-inventory</code>, which is the Ansible
inventory file for your cloud.</p><p>To configure the cloud to use this FQDN, use the inventory file
<code>/etc/fm-deploy/kolla-ansible-inventory</code> and Kolla Ansible&#x27;s
<code>reconfigure</code> subcommand.</p><p>For example:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">kolla-ansible -i /etc/fm-deploy/kolla-ansible-inventory reconfigure</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="enable-ssl-externally-encrypting-horizon-traffic">Enable SSL Externally, Encrypting Horizon Traffic<a class="hash-link" href="#enable-ssl-externally-encrypting-horizon-traffic" title="Direct link to heading">​</a></h2><p>This section outlines the steps required to install a signed SSL for
your cloud&#x27;s external, public network using Kolla Ansible.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="modify-kolla-ansible-configuration">Modify Kolla Ansible Configuration<a class="hash-link" href="#modify-kolla-ansible-configuration" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="configure-root-ca-bundle">Configure Root CA Bundle<a class="hash-link" href="#configure-root-ca-bundle" title="Direct link to heading">​</a></h4><p>OpenMetal private clouds are deployed with CentOS 8 as the operating
system. Kolla Ansible needs to be updated to point to the root CA bundle
for CentOS 8. To do so, modify <code>/etc/kolla/globals.yml</code> to reflect the
location of the root CA bundle for CentOS 8:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">openstack_cacert: &#x27;/etc/pki/tls/certs/ca-bundle.crt&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="prepare-ssl-file">Prepare SSL File<a class="hash-link" href="#prepare-ssl-file" title="Direct link to heading">​</a></h4><p>Your SSL files need to be prepared into a single file of <strong>PEM</strong> format,
including the private key, certificate, and intermediate chain. When
preparing the file ensure the order of the information is the private
key first, then the certificate, and finally the intermediate chain.</p><p>To prepare your SSL, concatenate the contents of the private key, the
certificate, and the intermediary chain into single file located
<code>/etc/kolla/certificates/&lt;certificate-name&gt;.pem</code>, where
<code>&lt;certificate-name&gt;</code> is the name of the certificate file.</p><p>Additionally, ensure <code>0600</code> permissions are set for the certificate
file:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 0600 /etc/kolla/certificates/&lt;certificate-name&gt;.pem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As an example, here&#x27;s truncated output including the headers of a
prepared SSL PEM file:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN PRIVATE KEY----- &lt;-- Private Key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END PRIVATE KEY-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE----- &lt;-- Certificate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE----- &lt;-- Intermediary Certificate #1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE----- &lt;-- Intermediary Certificate #2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Ensure your SSL PEM file reflects the above ordering otherwise Kolla
Ansible may fail to execute as expected.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="specify-ssl-certificate">Specify SSL Certificate<a class="hash-link" href="#specify-ssl-certificate" title="Direct link to heading">​</a></h4><p>Next, in <code>/etc/kolla/globals.yml</code>, ensure the key
<code>kolla_external_fqdn_cert</code> is set to the name of the certificate file.
<code>{{ node_config }}</code> in this case is defined as <code>/etc/kolla</code>.</p><p>For example:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">kolla_external_fqdn_cert: &#x27;{{ node_config }}/certificates/&lt;certificate-name&gt;.pem&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="enable-external-tls">Enable External TLS<a class="hash-link" href="#enable-external-tls" title="Direct link to heading">​</a></h4><p>Within <code>/etc/kolla/globals.yml</code>, ensure <code>kolla_enable_tls_external</code> is
set to <code>&#x27;yes&#x27;</code>:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">kolla_enable_tls_external: &#x27;yes&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="reconfigure-cloud-using-kolla-ansible">Reconfigure Cloud using Kolla Ansible<a class="hash-link" href="#reconfigure-cloud-using-kolla-ansible" title="Direct link to heading">​</a></h4><p>The previous steps conclude the preparation of the SSL file and the
Kolla Ansible configuration. Before proceeding with this step, ensure
you have <a href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/">prepared a Kolla Ansible
environment</a>.</p><p>Next, to configure the cloud to use this SSL, use the inventory file
<code>/etc/fm-deploy/kolla-ansible-inventory</code> and Kolla Ansible&#x27;s
<code>reconfigure</code> subcommand.</p><p>For example:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">kolla-ansible -i /etc/fm-deploy/kolla-ansible-inventory reconfigure</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="reconfigure-ceph-cluster-using-ceph-ansible">Reconfigure Ceph Cluster using Ceph Ansible<a class="hash-link" href="#reconfigure-ceph-cluster-using-ceph-ansible" title="Direct link to heading">​</a></h2><p>Additionally, the Ceph cluster needs to be reconfigured to update Swift
to point to the Keystone HTTPS endpoint instead of the HTTP version. In
this section we explain how to configure the new Swift endpoint using
Ceph Ansible.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="procedure">Procedure<a class="hash-link" href="#procedure" title="Direct link to heading">​</a></h3><p>First, ensure you have <a href="/openmetal-docs/docs/operators-manual/day-4/ceph-ansible">prepared a Ceph Ansible
environment</a>.</p><p>Next, load <code>./group_vars/all.yml</code> in an editor and find the line
containing the string <code>rgw keystone url:</code>. For this example, this line
appears this way:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">rgw keystone url: http://173.231.254.164:5000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This line tells Swift which URL to use to authenticate with Keystone.
Since the cloud now has an SSL configured externally, the Keystone URL
for Swift needs to include the HTTPS protocol.</p><p>In the file <code>./group_vars/all.yml</code>, ensure the line with <code>rgw keystone
url:</code> now specifies HTTPS instead of HTTP. For example:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">rgw keystone url: https://173.231.254.164:5000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Next, run Ceph Ansible, using:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ansible-playbook \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -i /etc/fm-deploy/ceph-inventory.yml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --private-key /root/.ssh/fm-deploy \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /opt/ceph-ansible/site.yml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="reference">Reference<a class="hash-link" href="#reference" title="Direct link to heading">​</a></h2><p><a href="https://docs.openstack.org/kolla-ansible/victoria/admin/tls.html" target="_blank" rel="noopener noreferrer">TLS Documentation from Kolla Ansible for OpenStack
Victoria</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openmetalio/openmetal-docs/blob/main/docs/operators-manual/day-4/kolla-ansible/enable-tls.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/enable-elk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to Enable Elasticsearch and Kibana using Kolla Ansible</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/openmetal-docs/docs/operators-manual/day-4/kolla-ansible/redeploy-rabbitmq"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to Redeploy OpenStack&#x27;s RabbitMQ Cluster using Kolla Ansible</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#specify-an-external-fully-qualified-domain-name-for-horizon" class="table-of-contents__link toc-highlight">Specify an External Fully Qualified Domain Name for Horizon</a><ul><li><a href="#determine-public-ip" class="table-of-contents__link toc-highlight">Determine Public IP</a></li><li><a href="#configure-an-fqdn" class="table-of-contents__link toc-highlight">Configure an FQDN</a></li><li><a href="#apply-configuration-change-using-kolla-ansible" class="table-of-contents__link toc-highlight">Apply Configuration Change Using Kolla Ansible</a></li></ul></li><li><a href="#enable-ssl-externally-encrypting-horizon-traffic" class="table-of-contents__link toc-highlight">Enable SSL Externally, Encrypting Horizon Traffic</a><ul><li><a href="#modify-kolla-ansible-configuration" class="table-of-contents__link toc-highlight">Modify Kolla Ansible Configuration</a></li></ul></li><li><a href="#reconfigure-ceph-cluster-using-ceph-ansible" class="table-of-contents__link toc-highlight">Reconfigure Ceph Cluster using Ceph Ansible</a><ul><li><a href="#procedure" class="table-of-contents__link toc-highlight">Procedure</a></li></ul></li><li><a href="#reference" class="table-of-contents__link toc-highlight">Reference</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/openmetal-docs/img/openmetal.svg" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/openmetal-docs/img/openmetal.svg" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright"><strong>2022 © OpenMetal, a division of <a href="https://www.inmotionhosting.com" target="_blank" rel="noopener">InMotion Hosting</a>.  All rights reserved.</strong></div></div><div class="footerContact_lPaK"><p>555 S. Independence Blvd, Virginia Beach, VA 23452</p><div class="contactLinks_EKti"><a href="tel:+18777289664">877-7-BUY-OMI</a><a href="mailto:sales@openmetal.io">sales@openmetal.io</a><a href="https://openmetal.io/schedule-meeting/">Schedule a Demo</a></div><p><strong>OpenMetal Central:</strong> <a target="_blank" href="https://central.openmetal.io/auth/sign-in">Login</a> or <a target="_blank" href="https://central.openmetal.io/sign-up">Create New Account</a></p></div></div></footer></div>
<script src="/openmetal-docs/assets/js/runtime~main.7dbb6dff.js"></script>
<script src="/openmetal-docs/assets/js/main.3b3d27ad.js"></script>
</body>
</html>