<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">How to Handle a Failed OpenStack Control Plane Node | Openmetal Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://openmetalio.github.io/openmetal-docs/docs/how-to-guides/recover-from-failed-control-plane-node"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="How to Handle a Failed OpenStack Control Plane Node | Openmetal Docs"><meta data-react-helmet="true" name="description" content="\[todo\] revise"><meta data-react-helmet="true" property="og:description" content="\[todo\] revise"><link data-react-helmet="true" rel="icon" href="/openmetal-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://openmetalio.github.io/openmetal-docs/docs/how-to-guides/recover-from-failed-control-plane-node"><link data-react-helmet="true" rel="alternate" href="https://openmetalio.github.io/openmetal-docs/docs/how-to-guides/recover-from-failed-control-plane-node" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://openmetalio.github.io/openmetal-docs/docs/how-to-guides/recover-from-failed-control-plane-node" hreflang="x-default"><link rel="stylesheet" href="/openmetal-docs/assets/css/styles.0b4a7092.css">
<link rel="preload" href="/openmetal-docs/assets/js/runtime~main.a78bd390.js" as="script">
<link rel="preload" href="/openmetal-docs/assets/js/main.32bb5b19.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/openmetal-docs/"><div class="navbar__logo"><img src="/openmetal-docs/img/openmetal.svg" alt="Openmetal" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/openmetal-docs/img/openmetal.svg" alt="Openmetal" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openmetalio/openmetal-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/openmetal-docs/docs/users_manual/">User&#x27;s Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;User&#x27;s Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/openmetal-docs/docs/operators-manual/">Operator&#x27;s Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator&#x27;s Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/openmetal-docs/docs/operators-manual-extras/">Operator&#x27;s Manual Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator&#x27;s Manual Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/openmetal-docs/docs/how-to-guides/horizon/live-migrate-instance">How to Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/how-to-guides/horizon/live-migrate-instance">Horizon</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/openmetal-docs/docs/how-to-guides/recoverinstance/recoveraninstance">Recover an Instance</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/openmetal-docs/docs/how-to-guides/recover-from-failed-control-plane-node">How to Handle a Failed OpenStack Control Plane Node</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>How to Handle a Failed OpenStack Control Plane Node</h1></header><p>[<!-- -->todo<!-- -->]<!-- --> revise</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>Private Cloud Core clouds come with three nodes comprising the core of
the cloud. These nodes are considered control plane nodes, because they
run all required OpenStack cloud services. In the event a control plane
node fails, how control plane node fails? What preparations can you make
prior to a failure event? This guide explains what you can do to get
your cloud back up and running. In addition, preparations can be made to
soften the impact a failure like this could have.</p><hr><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-do-you-know-a-control-plane-node-has-failed">How do you know a Control Plane node has failed?<a class="hash-link" href="#how-do-you-know-a-control-plane-node-has-failed" title="Direct link to heading">​</a></h2><p>First, you should be sure you have a failed control plane situation. The
node or instances hosted on it may be inaccessible due to a variety of
reasons. Perhaps Nova&#x27;s compute service failed or something similar is
going on. Contact our support via <a href="https://central.openmetal.io/" target="_blank" rel="noopener noreferrer">OpenMetal
Central</a> to determine if the node
actually needs to be replaced.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-do-you-replace-a-control-plane-node">How do you replace a Control Plane node?<a class="hash-link" href="#how-do-you-replace-a-control-plane-node" title="Direct link to heading">​</a></h2><p>There is no current self-service method for replacing a control plane
node. Our OpenMetal support staff will have to assist you with both
determining what the failure is and in recovering cloud functionality by
replacing the failed node with a new one. Submit a ticket through
<a href="https://central.openmetal.io/" target="_blank" rel="noopener noreferrer">OpenMetal Central</a> to have our agents
look into the issue.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ceph-storage-and-instance-recovery">Ceph Storage and Instance Recovery<a class="hash-link" href="#ceph-storage-and-instance-recovery" title="Direct link to heading">​</a></h2><p>Regardless of if you&#x27;re reading this and you have a failure on your
hands or not, it is best to be prepared when it comes to how important
data is stored.</p><p>Understand that with the way we deployed Ceph to Private Cloud Core
clouds, each control plane node is running a Ceph OSD daemon and each
Ceph pool is replicated three times, across each OSD. This means you
could lose one OSD, and still have your data replicated across the other
two.</p><p>If your persistent instance data is stored in Ceph, then that data is
replicated across each control plane node. Losing a control plane node
means any instances on that node will cease to function. However, if
those instances have their data stored within Ceph, then the data is not
lost because Ceph&#x27;s pools are replicated across each control plane node
via Ceph OSDs. There is a single Ceph OSD running per drive per control
plane node. In this scenario, to recover instances, you can attempt to
evacuate them to another node, should that node have enough resources.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="evacuate-instances">Evacuate Instances<a class="hash-link" href="#evacuate-instances" title="Direct link to heading">​</a></h2><p>If you are in a situation where you must get instances back online as
soon as possible, you can try evacuating them to another control plane
node. This section explains how to evacuate instances using Horizon.</p><hr><h3 class="anchor anchorWithStickyNavbar_y2LR" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h3><ul><li>A Horizon account with the <strong>admin</strong> role</li></ul><p>To begin evacuating instances, log in to Horizon with a user that has
the <strong>admin</strong> role. Typically you can use the &quot;admin&quot; account to
accomplish this.</p><p>Next, navigate to <strong>Admin -<!-- -->&gt;<!-- --> Compute -<!-- -->&gt;<!-- --> All Hypervisors</strong> to list
hypervisors. From here, click the <strong>Compute Host</strong> tab to list this
cloud&#x27;s compute hosts.</p><p>To evacuate instances, you must first disable the compute services for
the affected host. To do so, find the <strong>Actions</strong> column to the right
and click <strong>Disable Service</strong>. Upon doing this, a pop up appears
allowing to enter a reason for disabling the service. Following that a
new drop down will appear allowing you to migrate the instances to a new
host called <strong>Migrate Host</strong>.</p><p>Alternatively, if the compute service for the affected host is already
down, you will see a button to <strong>Evacuate Host</strong> under the <strong>Actions</strong>
column on the right.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>Should you think you have a failed control plane node, contact our
OpenMetal support who will be able to determine if that is the case and
also help in restoring cloud functionality.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openmetalio/openmetal-docs/blob/main/docs/how-to-guides/recover-from-failed-control-plane-node.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/openmetal-docs/docs/how-to-guides/recoverinstance/recoveraninstance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Recover an Instance Using Horizon</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#how-do-you-know-a-control-plane-node-has-failed" class="table-of-contents__link toc-highlight">How do you know a Control Plane node has failed?</a></li><li><a href="#how-do-you-replace-a-control-plane-node" class="table-of-contents__link toc-highlight">How do you replace a Control Plane node?</a></li><li><a href="#ceph-storage-and-instance-recovery" class="table-of-contents__link toc-highlight">Ceph Storage and Instance Recovery</a></li><li><a href="#evacuate-instances" class="table-of-contents__link toc-highlight">Evacuate Instances</a><ul><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/openmetal-docs/img/openmetal.svg" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/openmetal-docs/img/openmetal.svg" alt="Facebook Open Source Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright"><strong>2022 © OpenMetal, a division of <a href="https://www.inmotionhosting.com" target="_blank" rel="noopener">InMotion Hosting</a>.  All rights reserved.</strong></div></div><div class="footerContact_lPaK"><p>555 S. Independence Blvd, Virginia Beach, VA 23452</p><div class="contactLinks_EKti"><a href="tel:+18777289664">877-7-BUY-OMI</a><a href="mailto:sales@openmetal.io">sales@openmetal.io</a><a href="https://openmetal.io/schedule-meeting/">Schedule a Demo</a></div><p><strong>OpenMetal Central:</strong> <a target="_blank" href="https://central.openmetal.io/auth/sign-in">Login</a> or <a target="_blank" href="https://central.openmetal.io/sign-up">Create New Account</a></p></div></div></footer></div>
<script src="/openmetal-docs/assets/js/runtime~main.a78bd390.js"></script>
<script src="/openmetal-docs/assets/js/main.32bb5b19.js"></script>
</body>
</html>